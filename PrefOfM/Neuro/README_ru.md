# Модель классификации эмоций по аудио

Модель машинного обучения для анализа эмоционального состояния по голосу.

## Описание модели

Сверточная нейронная сеть (CNN), классифицирующая аудио на 5 категорий:
- позитив (positive)
- грусть (sad) 
- нейтрально (neutral)
- злость (angry)
- другое (other)

## Файлы в репозитории

1. **training.py** - скрипт для обучения модели
2. **test.py** - скрипт для тестирования модели (PyTorch версия)
3. **test_onnx.py** - скрипт для тестирования модели (ONNX версия)
4. **export_to_onnx.py** - скрипт для экспорта модели в формат ONNX
5. **label_encoder.pkl** - кодировщик меток эмоций
6. **emotion_model.pth** - веса предобученной модели PyTorch
7. **emotion_model.onnx** - модель в формате ONNX

## Подготовка данных

1. Скачайте датасет по инструкции:  
   [Golos Dataset README](https://github.com/salute-developers/golos/blob/master/dusha/README.md)

2. Создайте следующие папки:
   - `train_data/` - для обучающих данных
   - `test_data/` - для тестовых данных

3. Разместите файлы:
   - Обучающие .parquet файлы → `train_data/`
   - Тестовые .parquet файлы → `test_data/`
   - Все WAV-файлы → в соответствующие подпапки `wavs/`

## Использование

### Обучение модели
```bash
python training.py
```

### Тестирование модели
```bash
# PyTorch версия
python test.py

# ONNX версия  
python test_onnx.py
```

### Экспорт модели
```bash
python export_to_onnx.py
```

## Технические требования

- Python 3.7+
- PyTorch
- TorchAudio  
- ONNX Runtime
- scikit-learn
- pandas
- tqdm

Установка зависимостей:
```bash
pip install -r requirements.txt
```

## Производительность

Результаты на тестовой выборке:
- Общая точность: 71.23%
- Наилучшее качество на классе "нейтрально" (F1-score: 0.80)
- Подробные метрики представлены в файле test_result.png

## Интеграция

Модель может быть дообучена на новых данных и интегрирована в различные системы анализа аудиоконтента. Формат ONNX позволяет использовать модель в различных средах исполнения.